import{jsx as r,jsxs as k,Fragment as P}from"@dropins/tools/preact-jsx-runtime.js";import*as c from"@dropins/tools/preact-compat.js";import{useState as O,useEffect as ut}from"@dropins/tools/preact-compat.js";import{classes as y,VComponent as x,Slot as z}from"@dropins/tools/lib.js";/* empty css             */import{IllustratedMessage as dt,Icon as w,Button as gt,Divider as ft,Skeleton as mt,SkeletonRow as pt,InLineAlert as ht,CartList as M,CartItem as yt,Price as L,Image as kt}from"@dropins/tools/components.js";import{useText as B}from"@dropins/tools/i18n.js";import{s as vt,g as Ct}from"./state.js";import{events as Lt}from"@dropins/tools/event-bus.js";const wt=s=>c.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...s},c.createElement("g",{clipPath:"url(#clip0_102_196)"},c.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M18.3601 18.16H6.5601L4.8801 3H2.3501M19.6701 19.59C19.6701 20.3687 19.0388 21 18.2601 21C17.4814 21 16.8501 20.3687 16.8501 19.59C16.8501 18.8113 17.4814 18.18 18.2601 18.18C19.0388 18.18 19.6701 18.8113 19.6701 19.59ZM7.42986 19.59C7.42986 20.3687 6.79858 21 6.01986 21C5.24114 21 4.60986 20.3687 4.60986 19.59C4.60986 18.8113 5.24114 18.18 6.01986 18.18C6.79858 18.18 7.42986 18.8113 7.42986 19.59Z",stroke:"currentColor",strokeLinejoin:"round"}),c.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M5.25 6.37L20.89 8.06L20.14 14.8H6.19",stroke:"currentColor",strokeLinejoin:"round"})),c.createElement("defs",null,c.createElement("clipPath",{id:"clip0_102_196"},c.createElement("rect",{vectorEffect:"non-scaling-stroke",width:19.29,height:19.5,fill:"white",transform:"translate(2.3501 2.25)"})))),$=s=>c.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...s},c.createElement("g",{clipPath:"url(#clip0_4797_15331)"},c.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M10.25 20.91L1.5 17.55V6.51996L10.25 9.92996V20.91Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),c.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M6.24023 4.64001L14.9902 8.06001V11.42",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),c.createElement("path",{className:"error-icon",vectorEffect:"non-scaling-stroke",d:"M19 13.31L15.5 19.37H22.5L19 13.31Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),c.createElement("path",{className:"error-icon",vectorEffect:"non-scaling-stroke",d:"M19.0202 17.11H18.9802L18.9502 15.56H19.0502L19.0202 17.11ZM18.9602 18.29V18.06H19.0502V18.29H18.9602Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),c.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M19 12.16V6.51996L10.25 9.92996V20.91L14.27 19.37L14.4 19.32",stroke:"currentColor",strokeLinejoin:"round"}),c.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M1.5 6.51999L10.25 3.04999L19 6.51999L10.25 9.92999L1.5 6.51999Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})),c.createElement("defs",null,c.createElement("clipPath",{id:"clip0_4797_15331"},c.createElement("rect",{width:22,height:18.86,fill:"white",transform:"translate(1 2.54999)"})))),Et=s=>c.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...s},c.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M0.75 12C0.75 5.78421 5.78421 0.75 12 0.75C18.2158 0.75 23.25 5.78421 23.25 12C23.25 18.2158 18.2158 23.25 12 23.25C5.78421 23.25 0.75 18.2158 0.75 12Z",stroke:"currentColor"}),c.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M11.75 5.88423V4.75H12.25V5.88423L12.0485 13.0713H11.9515L11.75 5.88423ZM11.7994 18.25V16.9868H12.2253V18.25H11.7994Z",stroke:"currentColor"})),It=({className:s,children:E,ctaLinkURL:l,...m})=>{const d=B({emptyCart:"Cart.EmptyCart.heading",cta:"Cart.EmptyCart.cta"});return r("div",{...m,className:y(["cart-empty-cart",s]),children:r(dt,{className:y(["cart-empty-cart__wrapper",s]),"data-testid":"cart-empty-cart",heading:d.emptyCart,icon:r(w,{className:"cart-empty-cart__icon",source:wt}),action:l?r(gt,{"data-testid":"cart-empty-cart-button",size:"medium",variant:"primary",type:"submit",href:l,children:d.cta},"routeHome"):void 0})})},St=({className:s,children:E,heading:l,emptyCart:m,products:d,outOfStockMessage:p,loading:I=!0,...f})=>r("div",{...f,className:y(["cart-cart-summary-list",s]),children:I?r(_t,{}):k(P,{children:[(l||p)&&k("div",{"data-testid":"cart-summary-list-heading-wrapper",className:y(["cart-cart-summary-list__heading",["cart-cart-summary-list__heading--full-width",!d]]),children:[l&&k(P,{children:[r(x,{node:l,className:"cart-cart-summary-list__heading-text"}),r(ft,{variant:"primary",className:y(["cart-cart-summary-list__heading-divider"])})]}),p&&r(x,{node:p,className:"cart-cart-summary-list__out-of-stock-message"})]}),r("div",{className:y(["cart-cart-summary-list__content",["cart-cart-summary-list__content--empty",!d]]),children:d||r(x,{node:m,className:"cart-cart-summary-list__empty-cart"})})]})}),_t=()=>r(mt,{"data-testid":"cart-summary-list-skeleton",className:"cart-cart-summary-list__skeleton",rowGap:"medium",children:r(pt,{variant:"row",size:"xlarge",fullWidth:!0,lines:3,multilineGap:"small"})}),Nt=({initialData:s=null,hideHeading:E,routeProduct:l,routeEmptyCartCTA:m,onItemQuantityUpdate:d,onItemRemove:p,maxItems:I,slots:f,attributesToHide:h=[],...T})=>{var G;const[b,W]=O(!s),[a,q]=O(s),[S,F]=O(new Set),o=(G=vt.config)==null?void 0:G.shoppingCartDisplaySetting,i=B({file:"Cart.CartItem.file",files:"Cart.CartItem.files",heading:"Cart.Cart.heading",message:"Cart.CartItem.message",recipient:"Cart.CartItem.recipient",regularPrice:"Cart.CartItem.regularPrice",discountedPrice:"Cart.CartItem.discountedPrice",sender:"Cart.CartItem.sender",lowInventory:"Cart.CartItem.lowInventory",insufficientQuantity:"Cart.CartItem.insufficientQuantity",insufficientQuantityGeneral:"Cart.CartItem.insufficientQuantityGeneral",outOfStockHeading:"Cart.OutOfStockMessage.heading",outOfStockDescription:"Cart.OutOfStockMessage.message",outOfStockAlert:"Cart.OutOfStockMessage.alert",removeAction:"Cart.OutOfStockMessage.action"}),_=(t,e)=>{F(n=>(e?n.add(t):n.delete(t),new Set(n)))},N=(t,e)=>{_(t,!0),p&&e===0?p(t).finally(()=>{_(t,!1)}).catch(n=>{console.warn(n)}):d&&d(t,e).finally(()=>{_(t,!1)}).catch(n=>{console.warn(n)})};ut(()=>{const t=Lt.on("cart/data",e=>{q(e),W(!1)},{eager:!0});return()=>{t==null||t.off()}},[]);const R=(t,e)=>{if(h.includes("image"))return;const n=r(kt,{"data-testid":"cart-list-item-image",loading:e<4?"eager":"lazy",src:t.image.src,alt:t.image.alt,width:"300",height:"300",params:{width:300}});return l?r("a",{href:l(t),children:n}):n},D=t=>{if(!h.includes("name"))return r("span",{"data-testid":"cart-list-item-title",children:l?r("a",{href:l(t),children:t.name}):t.name})},J=t=>{if(!h.includes("configurations"))return{...t.bundleOptions,...t.selectedOptions,...t.customizableOptions,...t.recipient?{[i.recipient]:t.recipient}:null,...t.recipientEmail&&t.recipient?{[i.recipient]:`${t.recipient} (${t.recipientEmail})`}:null,...t.sender?{[i.sender]:t.sender}:null,...t.senderEmail&&t.sender?{[i.sender]:`${t.sender} (${t.senderEmail})`}:{},...t.message?{[i.message]:t.message}:null,...t.links&&t.links.count?t.links.count>1?{[i.files.replace("{count}",t.links.count.toString())]:t.links.result}:{[i.file.replace("{count}",t.links.count.toString())]:t.links.result}:null}},K=t=>{var e,n,g,u;return(o==null?void 0:o.price)==="INCLUDING_TAX"?t.discounted?{amount:t.regularPrice.value,currency:t.regularPrice.currency,style:{font:"inherit"},"data-testid":"including-tax-item-price"}:{amount:(e=t.taxedPrice)==null?void 0:e.value,currency:(n=t.taxedPrice)==null?void 0:n.currency,style:{font:"inherit"},"data-testid":"including-tax-item-price"}:{amount:(g=t.regularPrice)==null?void 0:g.value,currency:(u=t.regularPrice)==null?void 0:u.currency,style:{font:"inherit"},"data-testid":"regular-item-price"}},Y=t=>(o==null?void 0:o.price)==="INCLUDING_EXCLUDING_TAX"?r(L,{amount:t.rowTotal.value,currency:t.rowTotal.currency,"data-testid":"excluding-tax-total","aria-label":i.regularPrice}):void 0,tt=t=>{var g,u,C,V,X,j,Z,A,H,U;const e={"aria-label":i.regularPrice},n=t.discounted?{}:null;return["INCLUDING_TAX","INCLUDING_EXCLUDING_TAX"].includes(o==null?void 0:o.price)?(e.amount=(g=t.rowTotalIncludingTax)==null?void 0:g.value,e.currency=(u=t.rowTotalIncludingTax)==null?void 0:u.currency,e.variant=t.discounted?"strikethrough":"default",e["data-testid"]="including-tax-item-total",n&&(e.amount=(C=t.total)==null?void 0:C.value,e.currency=(V=t.total)==null?void 0:V.currency,n.amount=(X=t.rowTotalIncludingTax)==null?void 0:X.value,n.currency=(j=t.rowTotalIncludingTax)==null?void 0:j.currency,n.sale=!0,n["aria-label"]=i.discountedPrice,n["data-testid"]="discount-total")):(e.amount=(Z=t.total)==null?void 0:Z.value,e.currency=(A=t.total)==null?void 0:A.currency,e.variant=t.discounted?"strikethrough":"default",e["data-testid"]="regular-item-total",n&&(n.amount=(H=t.discountedTotal)==null?void 0:H.value,n.currency=(U=t.discountedTotal)==null?void 0:U.currency,n.sale=!0,n["aria-label"]=i.regularPrice,n["data-testid"]="discount-total")),{totalProps:e,discountProps:n}},et=t=>{var g,u;if(h.includes("warning"))return;const e=t.insufficientQuantity&&t.stockLevel?t.stockLevel==="noNumber"?i.insufficientQuantityGeneral:i.insufficientQuantity.replace("{inventory}",(g=t.stockLevel)==null?void 0:g.toString()).replace("{count}",t.quantity.toString()):"",n=t.lowInventory&&t.onlyXLeftInStock&&i.lowInventory.replace("{count}",(u=t.onlyXLeftInStock)==null?void 0:u.toString());return t.insufficientQuantity||t.lowInventory?k("span",{"data-testid":"item-warning",children:[r(w,{source:Et,size:"16"}),e||n]}):void 0},rt=t=>{if(!(h!=null&&h.includes("alert")))return t.outOfStock?k("span",{"data-testid":"item-alert",children:[r(w,{source:$,size:"16"}),i.outOfStockAlert]}):void 0},nt=t=>r("span",{"data-testid":"cart-list-item-sku",children:t.sku}),Q=t=>a!=null&&a.totalQuantity?a.items.filter(t).map((e,n)=>{const{totalProps:g,discountProps:u}=tt(e);return r(yt,{updating:S==null?void 0:S.has(e.uid),"data-testid":`cart-list-item-entry-${e.uid}`,image:R(e,n),title:D(e),sku:nt(e),price:r(L,{...K(e)}),quantity:e.quantity,total:k(P,{children:[r(L,{...g}),u&&r(L,{...u})]}),configurations:J(e),totalExcludingTax:Y(e),taxIncluded:(o==null?void 0:o.price)==="INCLUDING_TAX",taxExcluded:(o==null?void 0:o.price)==="INCLUDING_EXCLUDING_TAX",warning:et(e),alert:rt(e),onQuantity:d?C=>{N(e.uid,C)}:void 0,onRemove:p?()=>N(e.uid,0):void 0},e.uid)}):null,at=r(z,{name:"EmptyCart",slot:f==null?void 0:f.EmptyCart,context:{},children:r(It,{"data-testid":"empty-cart",ctaLinkURL:m==null?void 0:m()})}),ct=r(z,{name:"Heading",slot:f==null?void 0:f.Heading,context:{count:(a==null?void 0:a.totalQuantity)??0},children:r("div",{"data-testid":"default-cart-heading",children:i.heading.replace("{count}",((a==null?void 0:a.totalQuantity)??0).toString())})}),it=()=>{const t=a==null?void 0:a.items.filter(e=>e.outOfStock);t==null||t.forEach(e=>{N(e.uid,0)})},ot=Q(t=>t.outOfStock||t.insufficientQuantity||!1),st=a!=null&&a.hasOutOfStockItems?r(ht,{"data-testid":"cart-out-of-stock-message",icon:r(w,{source:$,size:"16"}),itemList:r(M,{"data-testid":"out-of-stock-cart-items",children:ot}),type:"warning",heading:i.outOfStockHeading,description:i.outOfStockDescription,variant:"primary",actionButtonPosition:"bottom",additionalActions:a!=null&&a.hasFullyOutOfStockItems?[{label:i.removeAction,onClick:it}]:void 0}):void 0,v=Q(t=>!t.outOfStock&&!t.insufficientQuantity),lt=a!=null&&a.totalQuantity?r(M,{"data-testid":"cart-list",children:v==null?void 0:v.slice(0,I??v.length)}):null;return r(St,{...T,heading:E?void 0:ct,loading:b,emptyCart:at,products:lt,outOfStockMessage:st})};Nt.getInitialData=async function(){return Ct()};export{Nt as C};
